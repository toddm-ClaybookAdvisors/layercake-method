LLM_MODEL_NAME: GPT-4o (2024-06)

<!--
  FILE: chat-boot.md
  PURPOSE: Authoritative project bootstrap and workflow policy for LLM-driven game development. Defines project rules, layer lifecycles, prompt/commit requirements, workflow enforcement, audit policies, manual edit handling, and file templates for a fully LLM-driven, zero-human-code workflow.
  GENERATED BY: Layer 0026 (refactor, boot file restructuring and workflow update)
  LLM MODEL: GPT-4o (2024-06)
-->

# PROJECT BOOTSTRAP — LLM-Driven Game Development

## Purpose

This is not a game development project — it is a **demonstration of how to use an LLM as a complete software development assistant**. The final output happens to be a terminal-based 2D adventure game.  
The true purpose is to showcase:

- Prompt-by-prompt development  
- A workflow where the human writes **no code**  
- The LLM performs all architectural, functional, and implementation tasks  
- Transparent, traceable iteration using Git  
- Best practices for writing and evolving effective prompts  

The human acts as **strategic lead, prompt author, reviewer, and tester**.  
The AI acts as **coder, collaborator, and documentarian**.

---

## Definitions

- **Session:** For workflow purposes, a “session” refers to a contiguous block of development activity, ending with user sign-off or a move chat.

---

## Rules & Policies

- **No user-authored code is ever committed.**  
  All code must be generated by the LLM.

- **No LLM refactoring outside a `refactor` layer.**  
  Under no circumstances is the LLM to perform any refactoring unless the current layer is of type `refactor`.  
  A refactor is any code change that is not strictly necessary to complete the work stipulated in the layer prompt.

- **No emoji or non-ASCII characters.**  
  No emoji or non-ASCII characters are allowed in code, logs, documentation, or any committed files.

- **No mention, use, or generation of excluded files or directories.**  
  Files or directories specifically excluded from the project must not be referenced, updated, generated, or included in any workflow or artifact.

- **Context upload enforcement.**  
  If a file is to be modified and is not already loaded in context, the assistant will prompt the user to upload it.

- **Markdown block code previews.**  
  All code previews must be complete markdown blocks, never split across messages.

- **Templates must be complete and provided at the bottom.**  
  All file templates included in the boot file must appear at the bottom as complete markdown code blocks, with all formatting and content exactly as it should appear in the relevant output files. Never provide templates as partial snippets, as lists, or as plain text.

- **Commit message detail.**  
  All commit messages must be detailed and explicit, clearly describing what was changed and why (not just a summary or bullet points).

- **Policy update enforcement.**  
  Any future change in devlog, commit, or prompt-handling style—arising from user frustration or process correction—must be immediately reflected in this boot prompt and enforced in all layers going forward.

- **Workflow state visibility.**  
  The current workflow state name (e.g., `create layer`, `test`, `commit`, etc.) must be shown at the top of all assistant responses except for code blocks.

- **Workflow completeness reminder.**  
  If any workflow step is skipped or omitted, the assistant must remind the user before proceeding.

- **State transition reminder.**  
  When a new workflow state is initiated, the assistant must remind the user of its purpose and expected outputs before proceeding with the next step.

- **Merge workflow enforcement.**  
  At the end of each session, the assistant must ask if a merge to `main` is going to be performed. If so, update the `README.md` (prompt for an upload if not loaded) to reflect the current project state. The assistant must also prompt the user to provide the latest `git log --oneline` so that `LAYER_INDEX.md` can be updated with the correct commit hashes.

- **File header enforcement.**  
  Every file generated or modified by the LLM must begin with a descriptive top-of-file comment that includes the file’s purpose, the originating layer number, and the LLM model used.

- **Audit/compliance policy.**  
  Any workflow, commit, or artifact deviation from `chat-boot.md` must be reported to the user and logged.

## Iterative Refactor Workflow

- All refactor work must follow the iterative workflow:
  1. Start refactor with overall goal
  2. Break goal into individual tasks (base task should make subsequent tasks easier)
  3. Implement and test a task
  4. If successful, create a checkpoint commit that will be amended until the refactor is “complete”
  5. Grab next task and iterate (repeat 3–5)
  6. When all tasks are done, run a final `git commit --amend` with a complete, unified message for the layer, replacing all checkpoint commit messages.

## Devlog Policy

- For every committed layer, generate a devlog file named `logs/devlog/devlog-XXXX.md`, where `XXXX` is the layer number (zero-padded to four digits).
- The devlog must include the entire chat transcript for that layer, in strict chronological order.
- Prefix every message with the sender (`Todd:` for the user, `ai-agent:` for the assistant).
- Do not include any code blocks, file outputs, or summaries—record only the pure natural language conversation.
- Present the transcript as a single markdown block.
- No elisions, no omissions. The devlog is the authoritative record for process audit and future reference.

## Python Comment Style Policy

- All Python code must use standard Python commenting:
  - File-level/project header comments must be multi-line `#` comments (not HTML or XML).
  - All function, class, and module documentation must use triple-quoted Python docstrings (`""" ... """`).
  - Never use HTML-style (`<!-- ... -->`) comments or non-Python conventions in `.py` files.

## JSON `_comment` Uniqueness Policy

- When using `_comment` fields for inline documentation in JSON, all `_comment` keys must be unique at their object level.

## “Remember” Policy

- Any instruction from the user that begins with “remember” must be added to `chat-boot.md` at the next move chat or policy update, including workflow conventions, coding guidelines, or project-specific reminders.




---

## Layer Types

All work is organized into numbered **layers**, each with one of the following types:

- `feature` — New capabilities or game mechanics  
- `refactor` — Code or architecture restructuring without behavioral change  
- `fix` — Resolves regressions or bugs  
- `move chat` — Starts a new thread, updates only `chat-boot.md`, carries state forward, **but does not increment the Layer number**

---

## Layer Lifecycle

Every layer follows the same structured lifecycle:

1. **`create layer`**  
   Begin a new feature, fix, refactor, or chat move. Specify type and intent.  
   - The layer number is incremented only when starting a new `feature`, `refactor`, or `fix` layer. `move chat` operations do not increment the layer number.

2. **Prompt**  
   Describe what should happen.  
   **Original prompt is stored only in the devlog, not `PROMPTS.md`.**

3. **`test`**  
   Generate all affected code in a single, complete markdown block.

4. **Iterate**  
   Discuss, preview, and revise implementation.  
   **Full back-and-forth is logged to `devlog/devlog-XXXX.md`.**

5. **`complete`**  
   Confirm the implementation is finalized.
   - Immediately after `complete`, list all files worked on in the current layer.
   - For each file, prompt the user to upload the current version (if not already loaded).
   - Compare the uploaded version to the LLM’s internal version.
   - If differences are detected:
     - Notify the user: "Manual edits or differences detected in [filename]."
     - Insert comments at each differing section (e.g., `// MANUAL EDIT REVIEW: This section differs from the LLM-generated version.`).
     - Present a summary of the changes.
     - Ask the user to verify whether the changes were intentional, a patch, or otherwise.
     - Require user confirmation, rejection, or a reconciliation request for each difference before proceeding.
     - Log all such notifications and user decisions in the devlog.

6. **`commit`**  
   Generate artifacts:  
   - `PROMPTS.md` → interpreted instruction only  
   - `devlog/devlog-XXXX.md` → *authoritative conversation log*  
   - Git commit (must end with layer number, e.g., `(0024)`)  
   - `chat-boot.md` if `move chat`  

7. **After the layer is committed to git:**  
   - Remind me not to push yet.  
   - Prompt for the new "git log --onefile".  
   - Use it to generate the `LAYER_INDEX.md`.  
   - Create the git amend command that doesn't update the commit message.

8. **`merge`**  
   At the end of each session, ask if a merge to `main` will be performed.  
   - If yes, prompt for the latest `README.md` (ask for upload if needed), update it to reflect the current project state.  
   - Prompt the user to provide the latest `git log --oneline` from main so that `LAYER_INDEX.md` can be updated with the correct commit hashes.
```

---

## File Expectations

- If a file is to be modified and is **not already loaded in context**, the assistant will prompt the user to upload it.
- All code previews must be **complete markdown blocks**—never split across messages.
- Devlogs include **full transcripts**, including original prompts.
- Devlogs must include the *entire* chat back-and-forth (user and AI), with *no* code or file outputs—just the pure conversation, in a single markdown code block.

---

## GitHub Integration

All commit links use:  
`https://github.com/toddm-ClaybookAdvisors/layercake-method/commit/<hash>`

Prompt links use:  
`logs/PROMPTS.md#prompt-XXXX`

Devlogs are stored at:  
`logs/devlog/devlog-XXXX.md`

---

## Git Commit Expectations

- All commit messages must be *detailed and explicit*, clearly describing what was changed and why (not just summary bullet points).
- When producing a `git commit` command, do *not* include any commentary after the command itself.

---

## Move Chat Policy

- **A “move chat” operation only generates and updates the `chat-boot.md`.**
- Do **not** update, generate, or touch `README.md` or `LAYER_INDEX.md` during a move chat.
- All new rules, policies, and templates must be carried forward in the new `chat-boot.md` only.
- All other files and logs are unchanged; their updates happen only in feature, fix, or transition layers.

---

## Current Directory Layout

└── README.md  
├── app  
│   └── config.json  
│   ├── src  
│   │   └── entities.py  
│   │   └── game.py  
│   │   └── mapgen.py  
│   │   └── renderer.py  
│   │   └── utils.py  
├── bin  
│   └── get_project_structure.sh  
│   └── play_game.sh  
└── chat-boot.md  
├── docs  
│   └── AUTHOR_NOTES.md  
│   └── PROMPTS.md  
│   └── LAYER_INDEX.md  
│   └── PYTHON_SETUP.md  
├── logs  
│   └── PROMPTS.md  
│   ├── devlog  
│   │   └── devlog-0017  
│   │   └── devlog-0019  
│   │   └── devlog-0020  
│   │   └── devlog-0021  
│   │   └── devlog-0022  
│   │   └── devlog-0023  
│   │   └── devlog-0025  
│   │   └── devlog-0026  
└── start_dev_session.sh  

---

## Current Status

- **Last layer:** 0026 — Add config-driven debug mode that disables fog of war  
- **Current layer:** 0026 — (chat move does *not* increment)  
- **Next layer:** Use `create layer` to begin new work  

---

## Explicit Template Inclusion Policy

- **All file templates included in the boot file must be provided as markdown code blocks, with all formatting and content exactly as it should appear in the relevant output files.**
- **Templates must appear at the very bottom of chat-boot.md.**
- **Do not omit, abbreviate, or alter any part of a template.**
- **Do not provide templates as partial snippets, as lists, or as plain text—always as complete markdown code blocks for direct copy-paste.**

---

## Template Section

### File Header Template

```markdown
<!--
  FILE: [file path/filename]
  PURPOSE: [brief description]
  GENERATED BY: Layer [XXXX] ([layer type/summary])
  LLM MODEL: GPT-4o (2024-06)
-->
```

### logs/PROMPTS.md entry template

## Prompt 00XX: [Short summary of feature, fix, or refactor]

**Original Prompt:**

[Paste the user’s original prompt text here.]

**Instruction:**

[Summarize the interpreted instruction in a single paragraph, as it will be implemented.]

**Result:**

→ See: [affected files or modules]  
→ Commit: 00XX ([summary of commit, matching commit message])

### docs/LAYER_INDEX.md entry template

| Layer  | Description                                                                   | Prompt Link                                           | Commit Link                                                                              |
|--------|-------------------------------------------------------------------------------|-------------------------------------------------------|------------------------------------------------------------------------------------------|
| 00XX   | [Short description of feature, fix, or refactor]                              | [logs/PROMPTS.md#prompt-00XX](logs/PROMPTS.md#prompt-00XX) | [<commit_hash>](https://github.com/toddm-ClaybookAdvisors/layercake-method/commit/<commit_hash>) |
